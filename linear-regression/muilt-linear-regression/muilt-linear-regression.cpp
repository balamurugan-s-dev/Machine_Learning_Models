#include <iostream>
#include <fstream>
#include <vector>
using namespace std;

int main(){
    vector<vector<double>> data = {
        {850,2,152000},{900,2,160500},{950,2,168200},{1000,2,175900},{1050,2,182700},
        {1100,2,190000},{1150,2,198000},{1200,3,220500},{1250,3,230800},{1300,3,241200},
        {1350,3,250400},{1400,3,260900},{1450,3,270500},{1500,3,280300},{1550,3,289600},
        {1600,3,299900},{1650,3,309200},{1700,3,318700},{1750,4,350000},{1800,4,361200},
        {1850,4,372800},{1900,4,384400},{1950,4,395300},{2000,4,407000},{2050,4,418600},
        {2100,4,430000},{2150,4,442400},{2200,4,453700},{2250,4,466500},{2300,4,478200},
        {2350,4,490300},{2400,4,502600},{2450,4,514900},{2500,4,527300},{2550,4,539800},
        {2600,4,552400},{2650,4,565200},{2700,4,578100},{2750,4,590000},{2800,4,603000},
        {2850,4,615500},{2900,4,628600},{2950,4,642000},{3000,4,655400},{3050,4,668900},
        {3100,4,682300},{3150,4,696800},{3200,4,710200},{3250,4,723600},{3300,4,737200},
        {3350,4,751500},{3400,4,765800},{3450,4,780200},{3500,4,794700},{3550,5,845000},
        {3600,5,861200},{3650,5,877800},{3700,5,893500},{3750,5,910000},{3800,5,927400},
        {3850,5,944200},{3900,5,961500},{3950,5,978800},{4000,5,995600},{4050,5,1012500},
        {4100,5,1029500},{4150,5,1046000},{4200,5,1063200},{4250,5,1080200},{4300,5,1096800},
        {4350,5,1114000},{4400,5,1132000},{4450,5,1150000},{4500,5,1167200},{4550,5,1184000},
        {4600,5,1202000},{4650,5,1220000},{4700,5,1238500},{4750,5,1256000},{4800,5,1273500},
        {4850,5,1291000},{4900,5,1309500},{4950,5,1327000},{5000,5,1345000},{5050,5,1363000},
        {5100,5,1381000},{5150,5,1399000},{5200,5,1418000},{5250,5,1436500},{5300,5,1455000},
        {5350,5,1473000},{5400,5,1492000},{5450,5,1510000},{5500,5,1529000},{5550,5,1547000},
        {5600,5,1565500},{5650,5,1584000},{5700,5,1602000},{5750,5,1621000},{5800,5,1639500},
        {5850,5,1658000},{5900,5,1676000},{5950,5,1695000},{6000,5,1714000}
    };


    int features = 2;
    vector<double> m(features, 0.0);
    double c = 0.0;
    double lr = 0.0000001;

    for(int epoch = 0; epoch < 5000000; epoch++){
        vector<double> dm(features, 0.0);
        double dc = 0;

        for(auto row: data){
            double y = row[2];

            double y_pred = 0;
            for(int j = 0; j < features; j++){
                y_pred += m[j] * row[j];
            }
            y_pred += c;

            double error = y - y_pred;

            for(int j = 0; j < features; j++){
                dm[j] += error * row[j];
            }
            dc += error;
        }

        for(int i = 0; i < features; i++){
            m[i] += lr* (dm[i]/data.size());
        }
        
        c += lr*(dc/data.size());
    }

    cout << "\nTrained Weights:\n";
    cout << "m1 = " << m[0] << endl;
    cout << "m2 = " << m[1] << endl;
    cout << "c  = " << c << endl;

    // test the model
    double sqft=1200, bedrooms=3;
    double pred = m[0]*sqft + m[1]*bedrooms + c;
    cout << "\nPrediction for 1500 sqft & 3 bedrooms = " << pred << endl;

    return 0;
}

// #include <iostream>
// #include <vector>
// using namespace std;

// int main(){
//     vector<vector<double>> data = {
//         {850,2,152000},{900,2,160500},{950,2,168200},{1000,2,175900},{1050,2,182700},
//         {1100,2,190000},{1150,2,198000},{1200,3,220500},{1250,3,230800},{1300,3,241200},
//         {1350,3,250400},{1400,3,260900},{1450,3,270500},{1500,3,280300},{1550,3,289600},
//         {1600,3,299900},{1650,3,309200},{1700,3,318700},{1750,4,350000},{1800,4,361200},
//         {1850,4,372800},{1900,4,384400},{1950,4,395300},{2000,4,407000},{2050,4,418600},
//         {2100,4,430000},{2150,4,442400},{2200,4,453700},{2250,4,466500},{2300,4,478200},
//         {2350,4,490300},{2400,4,502600},{2450,4,514900},{2500,4,527300},{2550,4,539800},
//         {2600,4,552400},{2650,4,565200},{2700,4,578100},{2750,4,590000},{2800,4,603000},
//         {2850,4,615500},{2900,4,628600},{2950,4,642000},{3000,4,655400},{3050,4,668900},
//         {3100,4,682300},{3150,4,696800},{3200,4,710200},{3250,4,723600},{3300,4,737200},
//         {3350,4,751500},{3400,4,765800},{3450,4,780200},{3500,4,794700},{3550,5,845000},
//         {3600,5,861200},{3650,5,877800},{3700,5,893500},{3750,5,910000},{3800,5,927400},
//         {3850,5,944200},{3900,5,961500},{3950,5,978800},{4000,5,995600},{4050,5,1012500},
//         {4100,5,1029500},{4150,5,1046000},{4200,5,1063200},{4250,5,1080200},{4300,5,1096800},
//         {4350,5,1114000},{4400,5,1132000},{4450,5,1150000},{4500,5,1167200},{4550,5,1184000},
//         {4600,5,1202000},{4650,5,1220000},{4700,5,1238500},{4750,5,1256000},{4800,5,1273500},
//         {4850,5,1291000},{4900,5,1309500},{4950,5,1327000},{5000,5,1345000},{5050,5,1363000},
//         {5100,5,1381000},{5150,5,1399000},{5200,5,1418000},{5250,5,1436500},{5300,5,1455000},
//         {5350,5,1473000},{5400,5,1492000},{5450,5,1510000},{5500,5,1529000},{5550,5,1547000},
//         {5600,5,1565500},{5650,5,1584000},{5700,5,1602000},{5750,5,1621000},{5800,5,1639500},
//         {5850,5,1658000},{5900,5,1676000},{5950,5,1695000},{6000,5,1714000}
//     };

//     double min_sq = 850, max_sq = 6000;
// double min_br = 2, max_br = 5;
// double min_y  = 152000, max_y = 1714000;

// for(auto &row:data){
//     row[0] = (row[0] - min_sq) / (max_sq - min_sq); // normalize sqft
//     row[1] = (row[1] - min_br) / (max_br - min_br); // normalize bedrooms
//     row[2] = (row[2]-min_y)/(max_y-min_y);     // price   <-- IMPORTANT
// }


//     int features = 2;
//     vector<double> m(features, 0.0);
//     double c = 0;
//     double lr = 0.015;

//     for(int epoch=0; epoch<800000; epoch++){
//         vector<double> dm(features, 0.0);
//         double dc = 0;

//         for(auto row: data){
//             double y = row[2];

//             double y_pred = 0;
//             for(int j=0; j<features; j++)
//                 y_pred += m[j] * row[j];
//             y_pred += c;

//             double error = y - y_pred;

//             for(int j=0; j<features; j++)
//                 dm[j] += error * row[j];

//             dc += error;
//         }

//         for(int j=0; j<features; j++)
//             m[j] += lr * (dm[j]/data.size());
        
//         c += lr * (dc/data.size());
//     }

//     cout << "\nTrained Weights:\n";
//     cout << "m1 = " << m[0] << endl;
//     cout << "m2 = " << m[1] << endl;
//     cout << "c  = " << c << endl;

//     // test the model
//     double nsq = (1500-min_sq)/(max_sq-min_sq);
// double nbr = (3-min_br)/(max_br-min_br);

// double y_norm = m[0]*nsq + m[1]*nbr + c;

// double y_pred = y_norm * (max_y-min_y) + min_y;
//     cout << "\nPrediction for 1500 sqft & 3 bedrooms = " << y_pred << endl;

//     return 0;
// }